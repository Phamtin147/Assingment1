<Window x:Class="FUMiniHotelSystemWPF.Views.AdminDashboardWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:FUMiniHotelSystemWPF.Converters"
        Title="Admin Dashboard" Height="768" Width="1366"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Background="{StaticResource BackgroundGradient}">
    
    <Window.Resources>
        <converters:BookingStatusConverter x:Key="BookingStatusConverter"/>
    </Window.Resources>
    
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="260"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        
        <!-- Sidebar -->
        <Border Grid.Column="0" Background="{StaticResource SidebarDarkBrush}" CornerRadius="0,20,0,0">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

                <!-- Logo & Title -->
                <StackPanel Grid.Row="0" Margin="20,30,20,40">
                    <Ellipse Width="60" Height="60" Margin="0,0,0,15">
                        <Ellipse.Fill>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                <GradientStop Color="#8b5fd3" Offset="0"/>
                                <GradientStop Color="#6c3fb5" Offset="1"/>
                            </LinearGradientBrush>
                        </Ellipse.Fill>
                    </Ellipse>
                    <TextBlock Text="🏨" FontSize="35" HorizontalAlignment="Center" Margin="0,-55,0,15"/>
                    
                    <TextBlock Text="Quản trị viên" 
                               FontSize="20" 
                               FontWeight="Bold" 
                               Foreground="{StaticResource TextWhiteBrush}" 
                               HorizontalAlignment="Center"/>
                    
                    <TextBlock x:Name="WelcomeTextBlock"
                               Text="{Binding WelcomeText}"
                               FontSize="12" 
                               Foreground="{StaticResource TextMutedBrush}" 
                               HorizontalAlignment="Center"
                               Margin="0,5,0,0"/>
                </StackPanel>
                
                <!-- Navigation Menu -->
                <StackPanel Grid.Row="1" Margin="10,0">
                    <Button x:Name="DashboardBtn" Style="{StaticResource SidebarButton}" Command="{Binding NavigateToDashboardCommand}" Tag="{Binding DashboardButtonTag}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📊" FontSize="18" Margin="0,0,15,0"/>
                            <TextBlock Text="Tổng quan" FontSize="14"/>
                        </StackPanel>
                    </Button>
                    
                    <Button x:Name="CustomersBtn" Style="{StaticResource SidebarButton}" Command="{Binding NavigateToCustomersCommand}" Tag="{Binding CustomersButtonTag}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="👥" FontSize="18" Margin="0,0,15,0"/>
                            <TextBlock Text="Khách hàng" FontSize="14"/>
                        </StackPanel>
                    </Button>
                    
                    <Button x:Name="RoomsBtn" Style="{StaticResource SidebarButton}" Command="{Binding NavigateToRoomsCommand}" Tag="{Binding RoomsButtonTag}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="🛏️" FontSize="18" Margin="0,0,15,0"/>
                            <TextBlock Text="Phòng" FontSize="14"/>
                        </StackPanel>
                    </Button>
                    
                    <Button x:Name="BookingsBtn" Style="{StaticResource SidebarButton}" Command="{Binding NavigateToBookingsCommand}" Tag="{Binding BookingsButtonTag}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📅" FontSize="18" Margin="0,0,15,0"/>
                            <TextBlock Text="Đặt phòng" FontSize="14"/>
                        </StackPanel>
                    </Button>
                    
                    <Button x:Name="ReportsBtn" Style="{StaticResource SidebarButton}" Command="{Binding NavigateToReportsCommand}" Tag="{Binding ReportsButtonTag}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📈" FontSize="18" Margin="0,0,15,0"/>
                            <TextBlock Text="Báo cáo" FontSize="14"/>
                        </StackPanel>
                    </Button>
        </StackPanel>

                <!-- Logout Button -->
                <Button Grid.Row="2" Style="{StaticResource ErrorButton}" 
                        Margin="10,10,10,20" Height="45"
                        Command="{Binding LogoutCommand}">
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <TextBlock Text="🚪" FontSize="18" Margin="0,0,10,0"/>
                        <TextBlock Text="Đăng xuất" FontSize="14"/>
                    </StackPanel>
                </Button>
            </Grid>
        </Border>
        
        <!-- Main Content Area -->
        <Grid Grid.Column="1" Margin="20">
            <!-- Dashboard View -->
            <Grid x:Name="DashboardView" Visibility="{Binding DashboardViewVisibility}">
                <StackPanel>
                    <TextBlock Text="📊 Dashboard" 
                               FontSize="28" 
                               FontWeight="Bold" 
                               Foreground="{StaticResource TextWhiteBrush}"
                               Margin="0,0,0,30"/>
                    
                    <!-- Stats Cards -->
                <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- Card 1 -->
                        <Border Grid.Column="0" Background="{StaticResource CardBackgroundBrush}" 
                                CornerRadius="15" Padding="20" Margin="0,0,10,0">
                            <StackPanel>
                                <TextBlock Text="👥" FontSize="30" Margin="0,0,0,10" Foreground="White"/>
                                <TextBlock x:Name="TotalCustomersText" Text="{Binding TotalCustomers}" 
                                           FontSize="32" FontWeight="Bold" 
                                           Foreground="{StaticResource TextWhiteBrush}"/>
                                <TextBlock Text="Tổng khách hàng" 
                                           Foreground="{StaticResource TextMutedBrush}" 
                                           FontSize="14"/>
                            </StackPanel>
                        </Border>
                        
                        <!-- Card 2 -->
                        <Border Grid.Column="1" Background="{StaticResource CardBackgroundBrush}" 
                                CornerRadius="15" Padding="20" Margin="5,0">
                            <StackPanel>
                                <TextBlock Text="🛏️" FontSize="30" Margin="0,0,0,10" Foreground="White"/>
                                <TextBlock x:Name="TotalRoomsText" Text="{Binding TotalRooms}" 
                                           FontSize="32" FontWeight="Bold" 
                                           Foreground="{StaticResource TextWhiteBrush}"/>
                                <TextBlock Text="Tổng phòng" 
                                           Foreground="{StaticResource TextMutedBrush}" 
                                           FontSize="14"/>
                            </StackPanel>
                        </Border>
                        
                        <!-- Card 3 -->
                        <Border Grid.Column="2" Background="{StaticResource CardBackgroundBrush}" 
                                CornerRadius="15" Padding="20" Margin="5,0">
                            <StackPanel>
                                <TextBlock Text="📅" FontSize="30" Margin="0,0,0,10" Foreground="White"/>
                                <TextBlock x:Name="TotalBookingsText" Text="{Binding TotalBookings}" 
                                           FontSize="32" FontWeight="Bold" 
                                           Foreground="{StaticResource TextWhiteBrush}"/>
                                <TextBlock Text="Tổng đặt phòng" 
                                           Foreground="{StaticResource TextMutedBrush}" 
                                           FontSize="14"/>
                            </StackPanel>
                        </Border>
                        
                        <!-- Card 4 -->
                        <Border Grid.Column="3" Background="{StaticResource CardBackgroundBrush}" 
                                CornerRadius="15" Padding="20" Margin="10,0,0,0">
                            <StackPanel>
                                <TextBlock Text="💰" FontSize="30" Margin="0,0,0,10" Foreground="White"/>
                                <TextBlock x:Name="TotalRevenueText" Text="{Binding TotalRevenue}" 
                                           FontSize="28" FontWeight="Bold" 
                                           Foreground="{StaticResource SuccessBrush}"/>
                                <TextBlock Text="Tổng doanh thu" 
                                           Foreground="{StaticResource TextMutedBrush}" 
                                           FontSize="14"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </StackPanel>
            </Grid>
            
            <!-- Customers View -->
            <Grid x:Name="CustomersView" Visibility="{Binding CustomersViewVisibility}">
                    <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Text="👥 Quản lý khách hàng" 
                           FontSize="28" FontWeight="Bold" 
                           Foreground="{StaticResource TextWhiteBrush}"
                           Margin="0,0,0,20"/>
                
                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,20">
                    <TextBox x:Name="CustomerSearchBox" 
                             Text="{Binding CustomerSearchText, UpdateSourceTrigger=PropertyChanged}"
                             Width="350" Height="45" 
                             Style="{StaticResource SearchTextBox}"
                             VerticalContentAlignment="Center"
                             Margin="0,0,15,0"/>
                    <Button Content="🔍 Tìm kiếm" 
                            Width="140" Height="45"
                            Style="{StaticResource ModernButton}"
                            Command="{Binding SearchCustomerCommand}"/>
                    <Button Content="➕ Thêm mới" 
                            Width="130" Height="45"
                            Style="{StaticResource SuccessButton}"
                            Margin="15,0,0,0" 
                            Command="{Binding AddCustomerCommand}"/>
                    </StackPanel>

                <Border Grid.Row="2" Background="{StaticResource CardBackgroundBrush}" 
                        CornerRadius="15" Padding="0">
                    <DataGrid x:Name="CustomerDataGrid" 
                              ItemsSource="{Binding Customers}"
                              Style="{StaticResource ModernDataGrid}"
                              ColumnHeaderStyle="{StaticResource ModernColumnHeader}"
                              CellStyle="{StaticResource ModernCell}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding CustomerID}" Width="60"/>
                            <DataGridTextColumn Header="Họ tên" Binding="{Binding CustomerFullName}" Width="*"/>
                            <DataGridTextColumn Header="Email" Binding="{Binding EmailAddress}" Width="*"/>
                            <DataGridTextColumn Header="Điện thoại" Binding="{Binding Telephone}" Width="140"/>
                            <DataGridTextColumn Header="Ngày sinh" Binding="{Binding CustomerBirthday, StringFormat=dd/MM/yyyy}" Width="120"/>
                            <DataGridTemplateColumn Header="Thao tác" Width="160">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <Button Content="✏️" Width="40" Height="32"
                                                    Style="{StaticResource IconButton}"
                                                    Margin="0,0,5,0" 
                                                    Command="{Binding DataContext.EditCustomerCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                    CommandParameter="{Binding CustomerID}"
                                                    ToolTip="Sửa"/>
                                            <Button Content="🗑️" Width="40" Height="32"
                                                    Style="{StaticResource IconButton}"
                                                    Command="{Binding DataContext.DeleteCustomerCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                    CommandParameter="{Binding CustomerID}"
                                                    ToolTip="Xóa"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>
                </Grid>

            <!-- Rooms View -->
            <Grid x:Name="RoomsView" Visibility="{Binding RoomsViewVisibility}">
                    <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Text="🛏️ Quản lý phòng" 
                           FontSize="28" FontWeight="Bold" 
                           Foreground="{StaticResource TextWhiteBrush}"
                           Margin="0,0,0,20"/>
                
                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,20">
                    <TextBox x:Name="RoomSearchBox" 
                             Text="{Binding RoomSearchText, UpdateSourceTrigger=PropertyChanged}"
                             Width="350" Height="45" 
                             Style="{StaticResource SearchTextBox}"
                             VerticalContentAlignment="Center"
                             Margin="0,0,15,0"/>
                    <Button Content="🔍 Tìm kiếm" 
                            Width="140" Height="45"
                            Style="{StaticResource ModernButton}"
                            Command="{Binding SearchRoomCommand}"/>
                    <Button Content="➕ Thêm mới" 
                            Width="130" Height="45"
                            Style="{StaticResource SuccessButton}"
                            Margin="15,0,0,0" 
                            Command="{Binding AddRoomCommand}"/>
                    </StackPanel>

                <Border Grid.Row="2" Background="{StaticResource CardBackgroundBrush}" 
                        CornerRadius="15" Padding="0">
                    <DataGrid x:Name="RoomDataGrid" 
                              ItemsSource="{Binding Rooms}"
                              Style="{StaticResource ModernDataGrid}"
                              ColumnHeaderStyle="{StaticResource ModernColumnHeader}"
                              CellStyle="{StaticResource ModernCell}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding RoomID}" Width="60"/>
                            <DataGridTextColumn Header="Số phòng" Binding="{Binding RoomNumber}" Width="120"/>
                            <DataGridTextColumn Header="Mô tả" Binding="{Binding RoomDescription}" Width="*"/>
                            <DataGridTextColumn Header="Loại phòng" Binding="{Binding RoomType.RoomTypeName}" Width="140"/>
                            <DataGridTextColumn Header="Sức chứa" Binding="{Binding RoomMaxCapacity}" Width="100"/>
                            <DataGridTextColumn Header="Giá/ngày" Binding="{Binding RoomPricePerDate, StringFormat=N0}" Width="120"/>
                            <DataGridTemplateColumn Header="Thao tác" Width="160">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <Button Content="✏️" Width="40" Height="32"
                                                    Style="{StaticResource IconButton}"
                                                    Margin="0,0,5,0" 
                                                    Command="{Binding DataContext.EditRoomCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                    CommandParameter="{Binding RoomID}"
                                                    ToolTip="Sửa"/>
                                            <Button Content="🗑️" Width="40" Height="32"
                                                    Style="{StaticResource IconButton}"
                                                    Command="{Binding DataContext.DeleteRoomCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                    CommandParameter="{Binding RoomID}"
                                                    ToolTip="Xóa"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>
            </Grid>
            
            <!-- Bookings View -->
            <Grid x:Name="BookingsView" Visibility="{Binding BookingsViewVisibility}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <TextBlock Grid.Row="0" Text="📅 Quản lý đặt phòng" 
                           FontSize="28" FontWeight="Bold" 
                           Foreground="{StaticResource TextWhiteBrush}"
                           Margin="0,0,0,20"/>
                
                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,20">
                    <Button Content="🔄 Làm mới" 
                            Width="130" Height="45"
                            Style="{StaticResource ModernButton}"
                            Command="{Binding RefreshBookingsCommand}"/>
                    <ComboBox x:Name="BookingStatusFilter" 
                              SelectedIndex="{Binding SelectedBookingStatusFilter, Mode=TwoWay}"
                              Width="180" Height="45" 
                              Margin="15,0,0,0"
                              Style="{StaticResource ModernComboBox}"
                              ItemContainerStyle="{StaticResource ModernComboBoxItem}">
                        <ComboBoxItem Content="Tất cả" Tag="0" IsSelected="True"/>
                        <ComboBoxItem Content="Chờ xác nhận" Tag="1"/>
                        <ComboBoxItem Content="Đã xác nhận" Tag="2"/>
                        <ComboBoxItem Content="Đã hủy" Tag="3"/>
                    </ComboBox>
                </StackPanel>
                
                <Border Grid.Row="2" Background="{StaticResource CardBackgroundBrush}" 
                        CornerRadius="15" Padding="0">
                    <DataGrid x:Name="AllBookingsDataGrid" 
                              ItemsSource="{Binding Bookings}"
                              Style="{StaticResource ModernDataGrid}"
                              ColumnHeaderStyle="{StaticResource ModernColumnHeader}"
                              CellStyle="{StaticResource ModernCell}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding BookingID}" Width="60"/>
                            <DataGridTextColumn Header="Khách hàng" Binding="{Binding Customer.CustomerFullName}" Width="*"/>
                            <DataGridTextColumn Header="Phòng" Binding="{Binding Room.RoomNumber}" Width="100"/>
                            <DataGridTextColumn Header="Check-in" Binding="{Binding CheckInDate, StringFormat=dd/MM/yyyy}" Width="120"/>
                            <DataGridTextColumn Header="Check-out" Binding="{Binding CheckOutDate, StringFormat=dd/MM/yyyy}" Width="120"/>
                            <DataGridTextColumn Header="Tổng tiền" Binding="{Binding TotalAmount, StringFormat=N0}" Width="130"/>
                            <DataGridTemplateColumn Header="Trạng thái" Width="130">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding BookingStatus, Converter={StaticResource BookingStatusConverter}}" 
                                                   HorizontalAlignment="Center"
                                                   Foreground="{StaticResource TextGrayBrush}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Thao tác" Width="160">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <Button Content="✏️" Width="40" Height="32"
                                                    Style="{StaticResource IconButton}"
                                                    Margin="0,0,5,0" 
                                                    Command="{Binding DataContext.EditBookingCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                    CommandParameter="{Binding BookingID}"
                                                    ToolTip="Sửa"/>
                                            <Button Content="❌" Width="40" Height="32"
                                                    Style="{StaticResource IconButton}"
                                                    Command="{Binding DataContext.CancelBookingCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                    CommandParameter="{Binding BookingID}"
                                                    ToolTip="Hủy"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>
                </Grid>

            <!-- Reports View -->
            <Grid x:Name="ReportsView" Visibility="{Binding ReportsViewVisibility}">
                    <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Text="📈 Báo cáo" 
                           FontSize="28" FontWeight="Bold" 
                           Foreground="{StaticResource TextWhiteBrush}"
                           Margin="0,0,0,20"/>
                
                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,20">
                    <TextBlock Text="Từ ngày:" 
                               VerticalAlignment="Center" 
                               Foreground="{StaticResource TextGrayBrush}"
                               Margin="0,0,10,0"/>
                    <DatePicker x:Name="StartDatePicker" 
                                SelectedDate="{Binding ReportStartDate}"
                                Width="150" Height="45" 
                                Margin="0,0,20,0"
                                Style="{StaticResource ModernDatePicker}"/>
                    <TextBlock Text="Đến ngày:" 
                               VerticalAlignment="Center" 
                               Foreground="{StaticResource TextGrayBrush}"
                               Margin="0,0,10,0"/>
                    <DatePicker x:Name="EndDatePicker" 
                                SelectedDate="{Binding ReportEndDate}"
                                Width="150" Height="45" 
                                Margin="0,0,20,0"
                                Style="{StaticResource ModernDatePicker}"/>
                    <Button Content="📊 Xem báo cáo" 
                            Width="150" Height="45"
                            Style="{StaticResource ModernButton}"
                            Command="{Binding ViewReportCommand}"/>
                    </StackPanel>

                <Border Grid.Row="2" Background="{StaticResource CardBackgroundBrush}" 
                        CornerRadius="15" Padding="0">
                    <DataGrid x:Name="ReportDataGrid" 
                              ItemsSource="{Binding ReportBookings}"
                              Style="{StaticResource ModernDataGrid}"
                              ColumnHeaderStyle="{StaticResource ModernColumnHeader}"
                              CellStyle="{StaticResource ModernCell}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding BookingID}" Width="80"/>
                            <DataGridTextColumn Header="Khách hàng" Binding="{Binding Customer.CustomerFullName}" Width="*"/>
                            <DataGridTextColumn Header="Phòng" Binding="{Binding Room.RoomNumber}" Width="100"/>
                            <DataGridTextColumn Header="Ngày đặt" Binding="{Binding BookingDate, StringFormat=dd/MM/yyyy}" Width="120"/>
                            <DataGridTextColumn Header="Check-in" Binding="{Binding CheckInDate, StringFormat=dd/MM/yyyy}" Width="120"/>
                            <DataGridTextColumn Header="Check-out" Binding="{Binding CheckOutDate, StringFormat=dd/MM/yyyy}" Width="120"/>
                            <DataGridTextColumn Header="Tổng tiền" Binding="{Binding TotalAmount, StringFormat=N0}" Width="150"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>
            </Grid>
                </Grid>
    </Grid>
</Window>
